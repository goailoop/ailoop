{
  "meta": {
    "generated_at": "2026-01-13T20:25:00.000000Z",
    "requirement_set": "req002",
    "purpose": "Implementable task graph derived from execution plan and contracts - agent-ready and dependency-aware",
    "rules_applied": [
      "Do NOT choose tech stack",
      "Tasks describable without code structure assumptions",
      "Tasks bounded (one deliverable per task)",
      "Prefer fewer tasks with clear scope"
    ]
  },
  "milestones": [
    {
      "id": "MS-01",
      "name": "Foundation: Mode Detection and Configuration",
      "tasks": ["T-001", "T-002", "T-003", "T-004"]
    },
    {
      "id": "MS-02",
      "name": "Direct Mode Support",
      "tasks": ["T-005", "T-006", "T-007", "T-008"]
    },
    {
      "id": "MS-03",
      "name": "Server Mode Core: Connection and Message Infrastructure",
      "tasks": ["T-009", "T-010", "T-011", "T-012", "T-013"]
    },
    {
      "id": "MS-04",
      "name": "Server Mode Client: Message Transmission",
      "tasks": ["T-014", "T-015"]
    },
    {
      "id": "MS-05",
      "name": "Server Mode Server: Message Reception and Queuing",
      "tasks": ["T-016", "T-017", "T-018"]
    },
    {
      "id": "MS-06",
      "name": "Server Mode Server: Message Display and Response Creation",
      "tasks": ["T-019", "T-020"]
    },
    {
      "id": "MS-07",
      "name": "Server Mode Server: Response Routing",
      "tasks": ["T-021", "T-022"]
    },
    {
      "id": "MS-08",
      "name": "Server Mode Client: Response Reception and Matching",
      "tasks": ["T-023", "T-024", "T-025"]
    },
    {
      "id": "MS-09",
      "name": "Error Handling and Validation",
      "tasks": ["T-026", "T-027", "T-028"]
    },
    {
      "id": "MS-10",
      "name": "Command Integration: Ask, Authorize, Say",
      "tasks": ["T-029", "T-030", "T-031"]
    },
    {
      "id": "MS-11",
      "name": "Quality and Negative Requirements",
      "tasks": ["T-032", "T-033", "T-034"]
    }
  ],
  "tasks": [
    {
      "id": "T-001",
      "title": "Implement mode detection component",
      "type": "logic",
      "owner_component": "COMP-001",
      "inputs": {
        "interfaces": [],
        "entities": [],
        "requirements": ["REQ-001", "REQ-003"]
      },
      "outputs": {
        "interfaces": ["IF-001"],
        "entities": ["ENTITY-008"],
        "artifacts": ["Mode detection implementation"]
      },
      "depends_on": [],
      "acceptance_gates": {
        "requirements_satisfied": ["REQ-001", "REQ-003"],
        "test_cases": ["TC-REQ-001-01", "TC-REQ-001-02", "TC-REQ-003-01"],
        "quality_contracts": ["QC-001", "QC-003"]
      },
      "notes": "Determine operation mode based on --server flag and AILOOP_SERVER env var. AILOOP_SERVER takes precedence. Must complete within 100ms. REQ-003: Handle --server flag to activate server mode.",
      "risk_flags": []
    },
    {
      "id": "T-002",
      "title": "Implement channel validation component",
      "type": "validation",
      "owner_component": "COMP-007",
      "inputs": {
        "interfaces": [],
        "entities": ["ENTITY-004"],
        "requirements": ["REQ-020", "REQ-033"]
      },
      "outputs": {
        "interfaces": ["IF-018"],
        "entities": ["ENTITY-004"],
        "artifacts": ["Channel validation implementation"]
      },
      "depends_on": [],
      "acceptance_gates": {
        "requirements_satisfied": ["REQ-020", "REQ-033"],
        "test_cases": ["TC-REQ-020-01", "TC-REQ-033-01"],
        "quality_contracts": ["QC-020", "QC-033"]
      },
      "notes": "Channel name validation must work identically in both direct and server modes. Prevents bypassing validation.",
      "risk_flags": []
    },
    {
      "id": "T-003",
      "title": "Implement configuration component",
      "type": "data",
      "owner_component": "COMP-008",
      "inputs": {
        "interfaces": [],
        "entities": [],
        "requirements": ["REQ-016", "REQ-017", "REQ-021"]
      },
      "outputs": {
        "interfaces": ["IF-021", "IF-022"],
        "entities": ["ENTITY-007"],
        "artifacts": ["Configuration management implementation"]
      },
      "depends_on": [],
      "acceptance_gates": {
        "requirements_satisfied": ["REQ-016", "REQ-017", "REQ-021"],
        "test_cases": ["TC-REQ-016-01", "TC-REQ-017-01", "TC-REQ-021-01"],
        "quality_contracts": ["QC-016", "QC-017", "QC-021"]
      },
      "notes": "Read timeout_seconds and output_format from configuration file. Support timeout_seconds=0 (indefinite) and >0 (finite). Maintain independent settings for direct and server modes.",
      "risk_flags": []
    },
    {
      "id": "T-004",
      "title": "Implement channel management component",
      "type": "data",
      "owner_component": "COMP-007",
      "inputs": {
        "interfaces": ["IF-018"],
        "entities": ["ENTITY-004"],
        "requirements": ["REQ-008", "REQ-029"]
      },
      "outputs": {
        "interfaces": ["IF-019", "IF-020"],
        "entities": ["ENTITY-004", "ENTITY-005"],
        "artifacts": ["Channel management implementation"]
      },
      "depends_on": ["T-002"],
      "acceptance_gates": {
        "requirements_satisfied": ["REQ-008", "REQ-029"],
        "test_cases": ["TC-REQ-008-01", "TC-REQ-029-01"],
        "quality_contracts": ["QC-008", "QC-029"]
      },
      "notes": "Maintain channel-specific queues with complete isolation. Messages in different channels cannot access each other.",
      "risk_flags": []
    },
    {
      "id": "T-005",
      "title": "Implement direct mode ask command handler",
      "type": "logic",
      "owner_component": "COMP-002",
      "inputs": {
        "interfaces": ["IF-001", "IF-018", "IF-021", "IF-022"],
        "entities": ["ENTITY-004", "ENTITY-007", "ENTITY-008"],
        "requirements": ["REQ-002", "REQ-020", "REQ-021"]
      },
      "outputs": {
        "interfaces": ["IF-002"],
        "entities": ["ENTITY-001"],
        "artifacts": ["Direct mode ask command implementation"]
      },
      "depends_on": ["T-001", "T-002", "T-003"],
      "acceptance_gates": {
        "requirements_satisfied": ["REQ-002", "REQ-020", "REQ-021"],
        "test_cases": ["TC-REQ-002-01", "TC-REQ-020-01", "TC-REQ-021-01"],
        "quality_contracts": ["QC-002", "QC-020", "QC-021"]
      },
      "notes": "Display question in local terminal, collect user response. Apply channel validation. Format output (JSON or plain text). Must maintain backward compatibility.",
      "risk_flags": []
    },
    {
      "id": "T-006",
      "title": "Implement direct mode authorize command handler",
      "type": "logic",
      "owner_component": "COMP-002",
      "inputs": {
        "interfaces": ["IF-001", "IF-018", "IF-021", "IF-022"],
        "entities": ["ENTITY-004", "ENTITY-007", "ENTITY-008"],
        "requirements": ["REQ-002", "REQ-020", "REQ-021"]
      },
      "outputs": {
        "interfaces": ["IF-003"],
        "entities": ["ENTITY-001"],
        "artifacts": ["Direct mode authorize command implementation"]
      },
      "depends_on": ["T-001", "T-002", "T-003"],
      "acceptance_gates": {
        "requirements_satisfied": ["REQ-002", "REQ-020", "REQ-021"],
        "test_cases": ["TC-REQ-002-01", "TC-REQ-020-01", "TC-REQ-021-01"],
        "quality_contracts": ["QC-002", "QC-020", "QC-021"]
      },
      "notes": "Display authorization request in local terminal, collect user decision (authorized/denied). Exit with code 0 for authorized, 1 for denied.",
      "risk_flags": []
    },
    {
      "id": "T-007",
      "title": "Implement direct mode say command handler",
      "type": "logic",
      "owner_component": "COMP-002",
      "inputs": {
        "interfaces": ["IF-001", "IF-018", "IF-021", "IF-022"],
        "entities": ["ENTITY-004", "ENTITY-007", "ENTITY-008"],
        "requirements": ["REQ-002", "REQ-020", "REQ-021"]
      },
      "outputs": {
        "interfaces": ["IF-004"],
        "entities": ["ENTITY-001"],
        "artifacts": ["Direct mode say command implementation"]
      },
      "depends_on": ["T-001", "T-002", "T-003"],
      "acceptance_gates": {
        "requirements_satisfied": ["REQ-002", "REQ-020", "REQ-021"],
        "test_cases": ["TC-REQ-002-01", "TC-REQ-020-01", "TC-REQ-021-01"],
        "quality_contracts": ["QC-002", "QC-020", "QC-021"]
      },
      "notes": "Display notification in local terminal. Complete immediately without waiting for response. Exit with code 0.",
      "risk_flags": []
    },
    {
      "id": "T-008",
      "title": "Implement output formatting component",
      "type": "logic",
      "owner_component": "COMP-010",
      "inputs": {
        "interfaces": ["IF-022"],
        "entities": ["ENTITY-007"],
        "requirements": ["REQ-021"]
      },
      "outputs": {
        "interfaces": ["IF-025"],
        "entities": [],
        "artifacts": ["Output formatting implementation"]
      },
      "depends_on": ["T-003"],
      "acceptance_gates": {
        "requirements_satisfied": ["REQ-021"],
        "test_cases": ["TC-REQ-021-01"],
        "quality_contracts": ["QC-021"]
      },
      "notes": "Format response data as JSON or plain text. Ensure JSON output structure and fields are identical in direct mode and server mode.",
      "risk_flags": []
    },
    {
      "id": "T-009",
      "title": "Implement WebSocket connection establishment",
      "type": "integration",
      "owner_component": "COMP-003",
      "inputs": {
        "interfaces": ["IF-001"],
        "entities": ["ENTITY-008"],
        "requirements": ["REQ-004", "REQ-035"]
      },
      "outputs": {
        "interfaces": ["IF-005"],
        "entities": ["ENTITY-002"],
        "artifacts": ["WebSocket connection implementation"]
      },
      "depends_on": ["T-001"],
      "acceptance_gates": {
        "requirements_satisfied": ["REQ-004", "REQ-035"],
        "test_cases": ["TC-REQ-004-01", "TC-REQ-004-02", "TC-REQ-035-01"],
        "quality_contracts": ["QC-004", "QC-035"]
      },
      "notes": "Convert server URL from http/https to ws/wss protocol. Validate URL format before connection attempt. Establish WebSocket connection. Handle connection errors.",
      "risk_flags": ["high_risk"]
    },
    {
      "id": "T-010",
      "title": "Implement correlation ID generation",
      "type": "logic",
      "owner_component": "COMP-005",
      "inputs": {
        "interfaces": [],
        "entities": [],
        "requirements": ["REQ-005", "REQ-027"]
      },
      "outputs": {
        "interfaces": ["IF-013"],
        "entities": ["ENTITY-001"],
        "artifacts": ["Correlation ID generation implementation"]
      },
      "depends_on": [],
      "acceptance_gates": {
        "requirements_satisfied": ["REQ-005", "REQ-027"],
        "test_cases": ["TC-REQ-005-01", "TC-REQ-005-02", "TC-REQ-027-01"],
        "quality_contracts": ["QC-005", "QC-027"]
      },
      "notes": "Generate globally unique correlation_id (UUID format 8-4-4-4-12 hexadecimal) for each message. Ensure uniqueness across all messages, connections, and channels.",
      "risk_flags": []
    },
    {
      "id": "T-011",
      "title": "Implement connection tracking component",
      "type": "data",
      "owner_component": "COMP-006",
      "inputs": {
        "interfaces": [],
        "entities": ["ENTITY-002"],
        "requirements": ["REQ-007", "REQ-028"]
      },
      "outputs": {
        "interfaces": ["IF-015", "IF-016", "IF-017"],
        "entities": ["ENTITY-003"],
        "artifacts": ["Connection tracking implementation"]
      },
      "depends_on": ["T-009"],
      "acceptance_gates": {
        "requirements_satisfied": ["REQ-007", "REQ-028"],
        "test_cases": ["TC-REQ-007-01", "TC-REQ-007-02", "TC-REQ-028-01"],
        "quality_contracts": ["QC-007", "QC-028"]
      },
      "notes": "Record mapping between incoming messages and originating WebSocket connections. Maintain mappings until response sent or connection closes. Provide lookup for response routing.",
      "risk_flags": []
    },
    {
      "id": "T-012",
      "title": "Implement connection lifecycle management",
      "type": "logic",
      "owner_component": "COMP-003",
      "inputs": {
        "interfaces": ["IF-005"],
        "entities": ["ENTITY-002"],
        "requirements": ["REQ-004"]
      },
      "outputs": {
        "interfaces": [],
        "entities": ["ENTITY-002"],
        "artifacts": ["Connection lifecycle management"]
      },
      "depends_on": ["T-009"],
      "acceptance_gates": {
        "requirements_satisfied": ["REQ-004"],
        "test_cases": ["TC-REQ-004-01", "TC-REQ-004-02"],
        "quality_contracts": ["QC-004"]
      },
      "notes": "Manage connection state transitions: establishing -> connected -> closed. Track connection timestamps.",
      "risk_flags": []
    },
    {
      "id": "T-013",
      "title": "Implement connection closure handling",
      "type": "logic",
      "owner_component": "COMP-006",
      "inputs": {
        "interfaces": ["IF-017"],
        "entities": ["ENTITY-002", "ENTITY-003"],
        "requirements": ["REQ-028", "REQ-030"]
      },
      "outputs": {
        "interfaces": ["IF-012"],
        "entities": [],
        "artifacts": ["Connection closure handling"]
      },
      "depends_on": ["T-011"],
      "acceptance_gates": {
        "requirements_satisfied": ["REQ-028", "REQ-030"],
        "test_cases": ["TC-REQ-028-01", "TC-REQ-030-01"],
        "quality_contracts": ["QC-028", "QC-030"]
      },
      "notes": "Handle connection closure events. Remove connection mappings when connection closes. Prevent sending responses to closed connections.",
      "risk_flags": []
    },
    {
      "id": "T-014",
      "title": "Implement message creation and serialization",
      "type": "logic",
      "owner_component": "COMP-003",
      "inputs": {
        "interfaces": ["IF-013", "IF-018"],
        "entities": ["ENTITY-001", "ENTITY-004"],
        "requirements": ["REQ-005", "REQ-006", "REQ-020", "REQ-033"]
      },
      "outputs": {
        "interfaces": ["IF-006"],
        "entities": ["ENTITY-001"],
        "artifacts": ["Message creation and serialization implementation"]
      },
      "depends_on": ["T-010", "T-002"],
      "acceptance_gates": {
        "requirements_satisfied": ["REQ-005", "REQ-006", "REQ-020", "REQ-033"],
        "test_cases": ["TC-REQ-005-01", "TC-REQ-005-02", "TC-REQ-006-01", "TC-REQ-020-01", "TC-REQ-033-01"],
        "quality_contracts": ["QC-005", "QC-006", "QC-020", "QC-033"]
      },
      "notes": "Create Message objects with unique correlation_id. Validate channel name before creating message. Serialize Message to valid JSON format.",
      "risk_flags": []
    },
    {
      "id": "T-015",
      "title": "Implement message transmission and pending request tracking",
      "type": "integration",
      "owner_component": "COMP-003",
      "inputs": {
        "interfaces": ["IF-005", "IF-006"],
        "entities": ["ENTITY-001", "ENTITY-002", "ENTITY-006"],
        "requirements": ["REQ-006"]
      },
      "outputs": {
        "interfaces": ["IF-008"],
        "entities": ["ENTITY-006"],
        "artifacts": ["Message transmission and tracking implementation"]
      },
      "depends_on": ["T-009", "T-014"],
      "acceptance_gates": {
        "requirements_satisfied": ["REQ-006"],
        "test_cases": ["TC-REQ-006-01"],
        "quality_contracts": ["QC-006"]
      },
      "notes": "Send serialized JSON message via WebSocket connection. Track pending requests keyed by correlation_id. Ensure messages arrive at server within 1 second.",
      "risk_flags": []
    },
    {
      "id": "T-016",
      "title": "Implement server message reception and validation",
      "type": "integration",
      "owner_component": "COMP-004",
      "inputs": {
        "interfaces": [],
        "entities": ["ENTITY-002"],
        "requirements": ["REQ-007", "REQ-031"]
      },
      "outputs": {
        "interfaces": ["IF-009", "IF-010"],
        "entities": ["ENTITY-001", "ENTITY-002"],
        "artifacts": ["Server message reception implementation"]
      },
      "depends_on": ["T-009", "T-015"],
      "acceptance_gates": {
        "requirements_satisfied": ["REQ-007", "REQ-031"],
        "test_cases": ["TC-REQ-007-01", "TC-REQ-007-02", "TC-REQ-031-01"],
        "quality_contracts": ["QC-007", "QC-031"]
      },
      "notes": "Accept WebSocket connections. Receive and deserialize Message objects. Validate message format and required fields. Reject malformed, missing field, or invalid type messages.",
      "risk_flags": []
    },
    {
      "id": "T-017",
      "title": "Implement server connection tracking",
      "type": "data",
      "owner_component": "COMP-004",
      "inputs": {
        "interfaces": ["IF-010", "IF-015"],
        "entities": ["ENTITY-001", "ENTITY-002", "ENTITY-003"],
        "requirements": ["REQ-007"]
      },
      "outputs": {
        "interfaces": [],
        "entities": ["ENTITY-003"],
        "artifacts": ["Server connection tracking implementation"]
      },
      "depends_on": ["T-011", "T-016"],
      "acceptance_gates": {
        "requirements_satisfied": ["REQ-007"],
        "test_cases": ["TC-REQ-007-01", "TC-REQ-007-02"],
        "quality_contracts": ["QC-007"]
      },
      "notes": "Record mapping between incoming messages and originating WebSocket connections. Maintain separate mappings for each connection.",
      "risk_flags": []
    },
    {
      "id": "T-018",
      "title": "Implement channel-specific message queuing",
      "type": "data",
      "owner_component": "COMP-004",
      "inputs": {
        "interfaces": ["IF-010", "IF-019"],
        "entities": ["ENTITY-001", "ENTITY-004", "ENTITY-005"],
        "requirements": ["REQ-008", "REQ-029"]
      },
      "outputs": {
        "interfaces": ["IF-020"],
        "entities": ["ENTITY-005"],
        "artifacts": ["Channel queuing implementation"]
      },
      "depends_on": ["T-004", "T-016"],
      "acceptance_gates": {
        "requirements_satisfied": ["REQ-008", "REQ-029"],
        "test_cases": ["TC-REQ-008-01", "TC-REQ-029-01"],
        "quality_contracts": ["QC-008", "QC-029"]
      },
      "notes": "Add messages to channel-specific queues. Maintain complete channel isolation. Messages in different channels cannot access each other.",
      "risk_flags": ["medium_risk"]
    },
    {
      "id": "T-019",
      "title": "Implement server terminal UI message display",
      "type": "ui",
      "owner_component": "COMP-004",
      "inputs": {
        "interfaces": ["IF-020"],
        "entities": ["ENTITY-005"],
        "requirements": ["REQ-009"]
      },
      "outputs": {
        "interfaces": [],
        "entities": [],
        "artifacts": ["Server terminal UI implementation"]
      },
      "depends_on": ["T-018"],
      "acceptance_gates": {
        "requirements_satisfied": ["REQ-009"],
        "test_cases": ["TC-REQ-009-01"],
        "quality_contracts": ["QC-009"]
      },
      "notes": "Display queued messages in server terminal UI within 500ms of enqueueing. Message content must match exactly what was sent. Messages appear in FIFO order.",
      "risk_flags": []
    },
    {
      "id": "T-020",
      "title": "Implement response message creation with correlation",
      "type": "logic",
      "owner_component": "COMP-004",
      "inputs": {
        "interfaces": ["IF-013"],
        "entities": ["ENTITY-001"],
        "requirements": ["REQ-010"]
      },
      "outputs": {
        "interfaces": ["IF-011"],
        "entities": ["ENTITY-001"],
        "artifacts": ["Response creation implementation"]
      },
      "depends_on": ["T-010", "T-019"],
      "acceptance_gates": {
        "requirements_satisfied": ["REQ-010"],
        "test_cases": ["TC-REQ-010-01"],
        "quality_contracts": ["QC-010"]
      },
      "notes": "Create response Message with correlation_id set to the id of the original request message. Support Answer, AuthorizationApproved, and AuthorizationDenied message types.",
      "risk_flags": []
    },
    {
      "id": "T-021",
      "title": "Implement response routing to originating connections",
      "type": "integration",
      "owner_component": "COMP-004",
      "inputs": {
        "interfaces": ["IF-011", "IF-016"],
        "entities": ["ENTITY-001", "ENTITY-002", "ENTITY-003"],
        "requirements": ["REQ-011", "REQ-026"]
      },
      "outputs": {
        "interfaces": [],
        "entities": [],
        "artifacts": ["Response routing implementation"]
      },
      "depends_on": ["T-017", "T-020"],
      "acceptance_gates": {
        "requirements_satisfied": ["REQ-011", "REQ-026"],
        "test_cases": ["TC-REQ-011-01", "TC-REQ-026-01"],
        "quality_contracts": ["QC-011", "QC-026"]
      },
      "notes": "Use connection tracking to identify originating connection. Route response via correct connection. Ensure responses never go to wrong connections.",
      "risk_flags": ["high_risk"]
    },
    {
      "id": "T-022",
      "title": "Implement closed connection detection and handling",
      "type": "logic",
      "owner_component": "COMP-004",
      "inputs": {
        "interfaces": ["IF-012", "IF-016"],
        "entities": ["ENTITY-002", "ENTITY-003"],
        "requirements": ["REQ-030"]
      },
      "outputs": {
        "interfaces": [],
        "entities": [],
        "artifacts": ["Closed connection handling"]
      },
      "depends_on": ["T-013", "T-021"],
      "acceptance_gates": {
        "requirements_satisfied": ["REQ-030"],
        "test_cases": ["TC-REQ-030-01"],
        "quality_contracts": ["QC-030"]
      },
      "notes": "Detect when originating connection is closed. Do not attempt to send response to closed connection. Handle gracefully without errors.",
      "risk_flags": []
    },
    {
      "id": "T-023",
      "title": "Implement response waiting with correlation matching",
      "type": "logic",
      "owner_component": "COMP-003",
      "inputs": {
        "interfaces": ["IF-007", "IF-014"],
        "entities": ["ENTITY-001", "ENTITY-006"],
        "requirements": ["REQ-012", "REQ-013", "REQ-034"]
      },
      "outputs": {
        "interfaces": [],
        "entities": ["ENTITY-006"],
        "artifacts": ["Response waiting and matching implementation"]
      },
      "depends_on": ["T-015", "T-021"],
      "acceptance_gates": {
        "requirements_satisfied": ["REQ-012", "REQ-013", "REQ-034"],
        "test_cases": ["TC-REQ-012-01", "TC-REQ-013-01", "TC-REQ-013-02", "TC-REQ-034-01"],
        "quality_contracts": ["QC-012", "QC-013", "QC-034"]
      },
      "notes": "Wait for response Message from server with matching correlation_id. Match response to pending request using correlation_id. Handle unmatched responses appropriately.",
      "risk_flags": []
    },
    {
      "id": "T-024",
      "title": "Implement timeout handling from configuration",
      "type": "logic",
      "owner_component": "COMP-003",
      "inputs": {
        "interfaces": ["IF-007", "IF-021"],
        "entities": ["ENTITY-006", "ENTITY-007"],
        "requirements": ["REQ-016", "REQ-017", "REQ-018"]
      },
      "outputs": {
        "interfaces": [],
        "entities": [],
        "artifacts": ["Timeout handling implementation"]
      },
      "depends_on": ["T-003", "T-023"],
      "acceptance_gates": {
        "requirements_satisfied": ["REQ-016", "REQ-017", "REQ-018"],
        "test_cases": ["TC-REQ-016-01", "TC-REQ-017-01", "TC-REQ-018-01"],
        "quality_contracts": ["QC-016", "QC-017", "QC-018"]
      },
      "notes": "Apply timeout_seconds from configuration. When timeout_seconds > 0, apply finite timeout. When timeout_seconds = 0, wait indefinitely. Handle timeout errors with appropriate messages.",
      "risk_flags": ["high_risk"]
    },
    {
      "id": "T-025",
      "title": "Implement timeout logic independence",
      "type": "quality",
      "owner_component": "COMP-003",
      "inputs": {
        "interfaces": ["IF-021"],
        "entities": ["ENTITY-007"],
        "requirements": ["REQ-036"]
      },
      "outputs": {
        "interfaces": [],
        "entities": [],
        "artifacts": ["Timeout independence verification"]
      },
      "depends_on": ["T-003", "T-024"],
      "acceptance_gates": {
        "requirements_satisfied": ["REQ-036"],
        "test_cases": ["TC-REQ-036-01"],
        "quality_contracts": ["QC-036"]
      },
      "notes": "Ensure timeout logic is independent for direct mode and server mode. Each mode uses its own timeout configuration.",
      "risk_flags": []
    },
    {
      "id": "T-026",
      "title": "Implement connection error formatting",
      "type": "error_handling",
      "owner_component": "COMP-009",
      "inputs": {
        "interfaces": [],
        "entities": [],
        "requirements": ["REQ-014", "REQ-025", "REQ-032"]
      },
      "outputs": {
        "interfaces": ["IF-023"],
        "entities": [],
        "artifacts": ["Connection error formatting implementation"]
      },
      "depends_on": ["T-009"],
      "acceptance_gates": {
        "requirements_satisfied": ["REQ-014", "REQ-025", "REQ-032"],
        "test_cases": ["TC-REQ-014-01", "TC-REQ-025-01", "TC-REQ-032-01"],
        "quality_contracts": ["QC-014", "QC-025", "QC-032"]
      },
      "notes": "Format connection error message: 'Failed to connect to server at {URL}: {error_type}. Ensure server is running and accessible.' Do not expose sensitive information (internal IPs, connection IDs, internal state). Exit with code 1. No fallback to direct mode.",
      "risk_flags": ["medium_risk"]
    },
    {
      "id": "T-027",
      "title": "Implement timeout error formatting",
      "type": "error_handling",
      "owner_component": "COMP-009",
      "inputs": {
        "interfaces": [],
        "entities": [],
        "requirements": ["REQ-018"]
      },
      "outputs": {
        "interfaces": ["IF-024"],
        "entities": [],
        "artifacts": ["Timeout error formatting implementation"]
      },
      "depends_on": [],
      "acceptance_gates": {
        "requirements_satisfied": ["REQ-018"],
        "test_cases": ["TC-REQ-018-01"],
        "quality_contracts": ["QC-018"]
      },
      "notes": "Format timeout error message when timeout expires. Exit with code 1.",
      "risk_flags": []
    },
    {
      "id": "T-028",
      "title": "Implement message format validation on server",
      "type": "validation",
      "owner_component": "COMP-004",
      "inputs": {
        "interfaces": ["IF-010"],
        "entities": ["ENTITY-001"],
        "requirements": ["REQ-031"]
      },
      "outputs": {
        "interfaces": [],
        "entities": [],
        "artifacts": ["Message format validation implementation"]
      },
      "depends_on": ["T-016"],
      "acceptance_gates": {
        "requirements_satisfied": ["REQ-031"],
        "test_cases": ["TC-REQ-031-01"],
        "quality_contracts": ["QC-031"]
      },
      "notes": "Validate message format, required fields, and field types. Reject malformed JSON, missing fields, and invalid types. Only process valid messages.",
      "risk_flags": []
    },
    {
      "id": "T-029",
      "title": "Integrate server mode ask command",
      "type": "integration",
      "owner_component": "COMP-003",
      "inputs": {
        "interfaces": ["IF-006", "IF-007", "IF-025"],
        "entities": ["ENTITY-001", "ENTITY-006", "ENTITY-007"],
        "requirements": ["REQ-022", "REQ-021"]
      },
      "outputs": {
        "interfaces": [],
        "entities": [],
        "artifacts": ["Server mode ask command integration"]
      },
      "depends_on": ["T-014", "T-015", "T-023", "T-024", "T-008"],
      "acceptance_gates": {
        "requirements_satisfied": ["REQ-022", "REQ-021"],
        "test_cases": ["TC-REQ-022-01", "TC-REQ-021-01"],
        "quality_contracts": ["QC-022", "QC-021"]
      },
      "notes": "Integrate ask command to work in server mode. Send question, wait for response subject to timeout rules, return response to agent. Ensure JSON output format consistency.",
      "risk_flags": []
    },
    {
      "id": "T-030",
      "title": "Integrate server mode authorize command",
      "type": "integration",
      "owner_component": "COMP-003",
      "inputs": {
        "interfaces": ["IF-006", "IF-007", "IF-025"],
        "entities": ["ENTITY-001", "ENTITY-006", "ENTITY-007"],
        "requirements": ["REQ-023", "REQ-021"]
      },
      "outputs": {
        "interfaces": [],
        "entities": [],
        "artifacts": ["Server mode authorize command integration"]
      },
      "depends_on": ["T-014", "T-015", "T-023", "T-024", "T-008"],
      "acceptance_gates": {
        "requirements_satisfied": ["REQ-023", "REQ-021"],
        "test_cases": ["TC-REQ-023-01", "TC-REQ-023-02", "TC-REQ-021-01"],
        "quality_contracts": ["QC-023", "QC-021"]
      },
      "notes": "Integrate authorize command to work in server mode. Send authorization request, wait for human decision subject to timeout rules, return approval/denial. Exit with code 0 for authorized, 1 for denied.",
      "risk_flags": []
    },
    {
      "id": "T-031",
      "title": "Integrate server mode say command",
      "type": "integration",
      "owner_component": "COMP-003",
      "inputs": {
        "interfaces": ["IF-006", "IF-025"],
        "entities": ["ENTITY-001", "ENTITY-007"],
        "requirements": ["REQ-024", "REQ-021"]
      },
      "outputs": {
        "interfaces": [],
        "entities": [],
        "artifacts": ["Server mode say command integration"]
      },
      "depends_on": ["T-014", "T-015", "T-008"],
      "acceptance_gates": {
        "requirements_satisfied": ["REQ-024", "REQ-021"],
        "test_cases": ["TC-REQ-024-01", "TC-REQ-021-01"],
        "quality_contracts": ["QC-024", "QC-021"]
      },
      "notes": "Integrate say command to work in server mode. Send notification message, complete immediately without waiting for response. Exit with code 0.",
      "risk_flags": []
    },
    {
      "id": "T-032",
      "title": "Verify channel isolation and correlation uniqueness",
      "type": "quality",
      "owner_component": "COMP-007",
      "inputs": {
        "interfaces": ["IF-019", "IF-020"],
        "entities": ["ENTITY-004", "ENTITY-005"],
        "requirements": ["REQ-027", "REQ-029"]
      },
      "outputs": {
        "interfaces": [],
        "entities": [],
        "artifacts": ["Quality verification: channel isolation and correlation uniqueness"]
      },
      "depends_on": ["T-004", "T-010", "T-018"],
      "acceptance_gates": {
        "requirements_satisfied": ["REQ-027", "REQ-029"],
        "test_cases": ["TC-REQ-027-01", "TC-REQ-029-01"],
        "quality_contracts": ["QC-027", "QC-029"]
      },
      "notes": "Verify channel isolation is maintained. Verify correlation_id global uniqueness across 1000 messages, different connections, and different channels.",
      "risk_flags": []
    },
    {
      "id": "T-033",
      "title": "Verify connection tracking persistence and routing accuracy",
      "type": "quality",
      "owner_component": "COMP-006",
      "inputs": {
        "interfaces": ["IF-015", "IF-016", "IF-017"],
        "entities": ["ENTITY-002", "ENTITY-003"],
        "requirements": ["REQ-028", "REQ-026"]
      },
      "outputs": {
        "interfaces": [],
        "entities": [],
        "artifacts": ["Quality verification: connection tracking and routing"]
      },
      "depends_on": ["T-011", "T-021"],
      "acceptance_gates": {
        "requirements_satisfied": ["REQ-028", "REQ-026"],
        "test_cases": ["TC-REQ-028-01", "TC-REQ-026-01"],
        "quality_contracts": ["QC-028", "QC-026"]
      },
      "notes": "Verify connection tracking information is not lost. Verify responses are routed to correct originating connections. Verify no responses go to wrong connections.",
      "risk_flags": []
    },
    {
      "id": "T-034",
      "title": "Verify negative requirements and quality attributes",
      "type": "quality",
      "owner_component": "COMP-002",
      "inputs": {
        "interfaces": [],
        "entities": [],
        "requirements": ["REQ-025", "REQ-030", "REQ-033", "REQ-036"]
      },
      "outputs": {
        "interfaces": [],
        "entities": [],
        "artifacts": ["Quality verification: negative requirements"]
      },
      "depends_on": ["T-005", "T-022", "T-025", "T-026"],
      "acceptance_gates": {
        "requirements_satisfied": ["REQ-025", "REQ-030", "REQ-033", "REQ-036"],
        "test_cases": ["TC-REQ-025-01", "TC-REQ-030-01", "TC-REQ-033-01", "TC-REQ-036-01"],
        "quality_contracts": ["QC-025", "QC-030", "QC-033", "QC-036"]
      },
      "notes": "Verify all negative requirements are satisfied: no fallback to direct mode, no responses to closed connections, no channel validation bypass, timeout logic independence.",
      "risk_flags": []
    }
  ],
  "build_order_components": [
    "COMP-001",
    "COMP-007",
    "COMP-008",
    "COMP-002",
    "COMP-010",
    "COMP-003",
    "COMP-005",
    "COMP-006",
    "COMP-004",
    "COMP-009"
  ],
  "parallel_groups": [
    {
      "group_id": "PG-01",
      "tasks": ["T-002", "T-003"],
      "description": "Channel validation and configuration can be implemented in parallel",
      "constraints": "Both are independent foundation components"
    },
    {
      "group_id": "PG-02",
      "tasks": ["T-005", "T-006", "T-007"],
      "description": "Direct mode command handlers can be implemented in parallel",
      "constraints": "All depend on T-001, T-002, T-003"
    },
    {
      "group_id": "PG-03",
      "tasks": ["T-010", "T-011"],
      "description": "Correlation ID generation and connection tracking can be implemented in parallel",
      "constraints": "Both are independent infrastructure components"
    },
    {
      "group_id": "PG-04",
      "tasks": ["T-017", "T-018"],
      "description": "Server connection tracking and channel queuing can be implemented in parallel",
      "constraints": "Both depend on T-016"
    },
    {
      "group_id": "PG-05",
      "tasks": ["T-026", "T-027"],
      "description": "Error formatting components can be implemented in parallel",
      "constraints": "Both are independent error handling components"
    },
    {
      "group_id": "PG-06",
      "tasks": ["T-029", "T-030", "T-031"],
      "description": "Command integrations can be implemented in parallel",
      "constraints": "All depend on T-014, T-015, T-023, T-024, T-008"
    }
  ],
  "open_questions": []
}
