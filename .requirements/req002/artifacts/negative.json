{
  "added_requirements": [
    {
      "id": "REQ-025",
      "ears_type": "unwanted",
      "statement": "System SHALL NOT fall back to direct mode when server connection fails in server mode.",
      "rationale": "Prevents silent mode switching that could confuse AI agents and ensures explicit error reporting when server is unreachable"
    },
    {
      "id": "REQ-026",
      "ears_type": "unwanted",
      "statement": "System SHALL NOT route response messages to incorrect WebSocket connections.",
      "rationale": "Maintains message integrity and ensures responses reach the correct requesting client"
    },
    {
      "id": "REQ-027",
      "ears_type": "unwanted",
      "statement": "System SHALL NOT allow duplicate correlation_id values across different messages.",
      "rationale": "Prevents response matching errors and ensures each request can be uniquely identified and matched to its response"
    },
    {
      "id": "REQ-028",
      "ears_type": "unwanted",
      "statement": "System SHALL NOT lose connection tracking information when WebSocket connection is established.",
      "rationale": "Ensures server can route responses back to originating connections and prevents orphaned requests"
    },
    {
      "id": "REQ-029",
      "ears_type": "unwanted",
      "statement": "System SHALL NOT process messages from channels other than the channel specified in the message.",
      "rationale": "Maintains channel isolation and prevents cross-channel message leakage"
    },
    {
      "id": "REQ-030",
      "ears_type": "unwanted",
      "statement": "System SHALL NOT send response messages if the originating WebSocket connection has been closed.",
      "rationale": "Prevents errors and resource waste when attempting to send responses to closed connections"
    },
    {
      "id": "REQ-031",
      "ears_type": "unwanted",
      "statement": "System SHALL NOT allow WebSocket connections without proper message format validation.",
      "rationale": "Prevents malformed messages from causing system errors or security issues"
    },
    {
      "id": "REQ-032",
      "ears_type": "unwanted",
      "statement": "System SHALL NOT expose sensitive connection details (internal IPs, connection IDs, internal state) in error messages to clients.",
      "rationale": "Protects system internals and prevents information leakage that could aid attackers"
    },
    {
      "id": "REQ-033",
      "ears_type": "unwanted",
      "statement": "System SHALL NOT allow messages to bypass channel validation in server mode.",
      "rationale": "Ensures channel isolation is maintained consistently across both direct and server modes"
    },
    {
      "id": "REQ-034",
      "ears_type": "unwanted",
      "statement": "System SHALL NOT process responses with correlation_id that does not match any pending request without logging or handling appropriately.",
      "rationale": "Prevents silent failures and ensures system can detect and handle orphaned or invalid responses"
    },
    {
      "id": "REQ-035",
      "ears_type": "unwanted",
      "statement": "System SHALL NOT allow AILOOP_SERVER environment variable to point to invalid or malicious URLs without validation.",
      "rationale": "Prevents connection attempts to invalid destinations and protects against potential security issues"
    },
    {
      "id": "REQ-036",
      "ears_type": "unwanted",
      "statement": "System SHALL NOT mix timeout handling between direct mode and server mode - each mode SHALL have independent timeout logic.",
      "rationale": "Ensures timeout behavior is consistent and predictable within each operation mode"
    }
  ],
  "updated_requirements": [],
  "open_questions": []
}
